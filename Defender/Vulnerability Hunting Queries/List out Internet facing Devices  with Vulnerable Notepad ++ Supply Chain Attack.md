## üîç KQL Description
#### This KQL query identifies internet-facing devices that have Notepad++ installed with versions outside the approved/safe list. It correlates software inventory with device exposure data to highlight externally exposed systems, summarizes the affected Notepad++ versions per device, and prioritizes results based on exposure level for risk-based remediation.
## üß© MITRE ATT&CK Mapping
#### Tactic:TA0001 Initial Access
```KQL
DeviceTvmSoftwareInventory
| where SoftwareName contains "Notepad++"
| extend Version = parse_version(SoftwareVersion)
| where Version < parse_version("8.8.9")
| join kind=inner (
    DeviceInfo
    | where IsInternetFacing == true
) on DeviceId
| summarize
    DeviceName        = any(DeviceName),
    OSPlatform        = any(OSPlatform),
    PublicIP          = any(PublicIP),
    ExposureLevel     = any(ExposureLevel),
    IsInternetFacing  = any(IsInternetFacing),
    SoftwareName      = any(SoftwareName),
    InstalledVersions = make_set(SoftwareVersion),
    VersionCount      = dcount(SoftwareVersion)
  by DeviceId
| order by ExposureLevel desc
```
